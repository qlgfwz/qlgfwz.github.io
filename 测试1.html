<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>凄凉端口已连接</title>
  <style>
    html, body {
      margin: 0px;
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: #000;
      background-size: 100vh;
    }

    #canvas {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .div1 {
      text-shadow: rgba(255, 255, 255, 0.5) 0 5px 6px, rgba(255, 255, 255, 0.2) 1px 3px 3px;
      text-align: center;
      position: relative;
      text-transform: uppercase;
      color: #fff;
      font-size: 3vw;
      letter-spacing: 1.2vw;
      font-weight: 400;
      padding-bottom: 15px;
    }

    .owText {
      left: 0;
      letter-spacing: 5px;
      font-size: 4vw;
      text-align: center;
      text-transform: uppercase;
      animation: move linear 5000ms infinite;
    }

    @keyframes move {
      0% {
        text-shadow:
          4px -4px 0 hsla(0, 100%, 50%, 1),
          3px -3px 0 hsla(0, 100%, 50%, 1),
          2px -2px 0 hsla(0, 100%, 50%, 1),
          1px -1px 0 hsla(0, 100%, 50%, 1),
          -4px 4px 0 hsla(180, 100%, 50%, 1),
          -3px 3px 0 hsla(180, 100%, 50%, 1),
          -2px 2px 0 hsla(180, 100%, 50%, 1),
          -1px 1px 0 hsla(180, 100%, 50%, 1);
      }
      25% {
        text-shadow:
          -4px -4px 0 hsla(180, 100%, 50%, 1),
          -3px -3px 0 hsla(180, 100%, 50%, 1),
          -2px -2px 0 hsla(180, 100%, 50%, 1),
          -1px -1px 0 hsla(180, 100%, 50%, 1),
          4px 4px 0 hsla(0, 100%, 50%, 1),
          3px 3px 0 hsla(0, 100%, 50%, 1),
          2px 2px 0 hsla(0, 100%, 50%, 1),
          1px 1px 0 hsla(0, 100%, 50%, 1);
      }
      50% {
        text-shadow:
          -4px 4px 0 hsla(0, 100%, 50%, 1),
          -3px 3px 0 hsla(0, 100%, 50%, 1),
          -2px 2px 0 hsla(0, 100%, 50%, 1),
          -1px 1px 0 hsla(0, 100%, 50%, 1),
          4px -4px 0 hsla(180, 100%, 50%, 1),
          3px -3px 0 hsla(180, 100%, 50%, 1),
          2px -2px 0 hsla(180, 100%, 50%, 1),
          1px -1px 0 hsla(180, 100%, 50%, 1);
      }
      75% {
        text-shadow:
          4px 4px 0 hsla(180, 100%, 50%, 1),
          3px 3px 0 hsla(180, 100%, 50%, 1),
          2px 2px 0 hsla(180, 100%, 50%, 1),
          1px 1px 0 hsla(180, 100%, 50%, 1),
          -4px -4px 0 hsla(0, 100%, 50%, 1),
          -3px -3px 0 hsla(0, 100%, 50%, 1),
          -2px -2px 0 hsla(0, 100%, 50%, 1),
          -1px -1px 0 hsla(0, 100%, 50%, 1);
      }
      100% {
        text-shadow:
          4px -4px 0 hsla(0, 100%, 50%, 1),
          3px -3px 0 hsla(0, 100%, 50%, 1),
          2px -2px 0 hsla(0, 100%, 50%, 1),
          1px -1px 0 hsla(0, 100%, 50%, 1),
          -4px 4px 0 hsla(180, 100%, 50%, 1),
          -3px 3px 0 hsla(180, 100%, 50%, 1),
          -2px 2px 0 hsla(180, 100%, 50%, 1),
          -1px 1px 0 hsla(180, 100%, 50%, 1);
      }
    }

    @import url(https://fonts.googleapis.com/css?family=Open+Sans:800);

    .d1 {
      font-size: 5vw;
      color: #e7e7e7;
      text-shadow: 1.5px 1.5px 0 #333, 0px 1.5px 0 #333, -1.5px -1.5px 0 #333, -1.5px -1.5px 0 #333, -1.5px 1.5px 0 #333, 1.5px -1.5px 0 #333, 0.77782px 0.77782px 0 #aaaaaa, 1.55563px 1.55563px 0 #aaaaaa, 2.33345px 2.33345px 0 #aaaaaa, 3.11127px 3.11127px 0 #aaaaaa, 3.88909px 3.88909px 0 #aaaaaa, 4.6669px 4.6669px 0 #aaaaaa, 5.44472px 5.44472px 0 #aaaaaa, 6.22254px 6.22254px 0 #aaaaaa, 7.00036px 7.00036px 0 #aaaaaa, 7.77817px 7.77817px 0 #aaaaaa;
    }

    .canvas {
      height: 100%;
      position: absolute;
      left: 50%;
      width: 100%;
      top: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }

    .progress {
      position: relative;
      display: inline-block;
      padding: 0;
      text-align: center;
    }

    .progress>li {
      display: inline-block;
      position: relative;
      text-align: center;
      color: #93A2AC;
      font-family: Lato;
      font-weight: 100;
    }

    .progress>li:before {
      content: attr(data-name);
      position: absolute;
      width: 100%;
      bottom: -2rem;
      font-weight: 400;
    }

    .progress>li:after {
      content: attr(data-percent);
      position: absolute;
      width: 100%;
      top: 3.7rem;
      left: 0;
      font-size: 2rem;
      text-align: center;
    }

    .progress svg {
      width: 10rem;
      height: 10rem;
    }

    .progress svg:nth-child(2) {
      position: absolute;
      left: 0;
      top: 0;
      transform: rotate(-90deg);
    }

    .progress svg:nth-child(2) path {
      fill: none;
      stroke-width: 25;
      stroke-dasharray: 629;
      stroke: #fff;
      opacity: .9;
      animation: load 10s;
    }

    .d2 {
      text-shadow: rgba(255, 255, 255, 0.5) 0 5px 6px, rgba(255, 255, 255, 0.2) 1px 3px 3px;
    }

    .text {
      background-image: linear-gradient(to right, blue, #66ffff 10%, #cc00ff 20%, #CC00CC 30%, #CCCCFF 40%, #00FFFF 50%, #CCCCFF 60%, #CC00CC 70%, #CC00FF 80%, #66FFFF 90%, blue 100%);
      -webkit-text-fill-color: transparent;
      background-clip: text;
      background-size: 200% 100%;
      animation: masked-animation 4s linear infinite;
      font-size: 25px;
      padding-bottom: 10px;
    }

    @keyframes masked-animation {
      0% { background-position: 0 0; }
      100% { background-position: -100% 0; }
    }

    img {
      position: relative;
      left: 9990px;
      width: 10rem;
      height: 10rem;
      border-radius: 50%;
      margin-top: 200px;
    }

    audio {
      position: absolute;
      left: 50%;
      margin-left: -100px;
      bottom: 0;
      margin-top: 290px;
      width: 200px;
      height: 50px;
    }

    p {
      margin: 0;
      padding: 0;
    }

    #clock {
      font-family: "Share Tech Mono", monospace;
      color: #ffffff;
      text-align: center;
      position: absolute;
      left: 50%;
      top: 300px;
      transform: translate(-50%, -50%);
      color: #daf6ff;
      text-shadow: 0 0 20px #0aafe6, 0 0 20px rgba(10, 175, 230, 0);
    }

    #clock .time {
      letter-spacing: 0.05em;
      font-size: 80px;
      padding: 5px 0;
    }

    #clock .date {
      letter-spacing: 0.1em;
      font-size: 24px;
    }

    .d6 {
      position: relative;
      left: 50%;
      margin-left: -150px;
      top: 7%;
      width: 300px;
      height: 70px;
    }

    a {
      float: left;
      width: 300px;
      height: 70px;
      border: 2px solid #ededed;
      border-radius: 15px;
      color: skyblue;
      text-align: center;
      line-height: 70px;
      font-size: 45px;
      font-family: '楷体';
      text-decoration: none;
    }

    .box {
      position: relative;
      height: 900px;
      margin-top: 450px;
    }

    /* 新增样式：可点击圆圈和游戏菜单 */
    .clickable-circle {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 120px;
      height: 120px;
      background: rgba(42, 161, 152, 0.7);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: all 0.3s ease;
      box-shadow: 0 0 20px rgba(42, 161, 152, 0.5);
      border: 2px solid rgba(255, 255, 255, 0.3);
      animation: pulse 2s infinite;
    }

    .clickable-circle:hover {
      transform: translate(-50%, -50%) scale(1.1);
      box-shadow: 0 0 30px rgba(42, 161, 152, 0.8);
      background: rgba(42, 161, 152, 0.9);
    }

    .clickable-circle:active {
      transform: translate(-50%, -50%) scale(0.95);
    }

    .clickable-circle span {
      color: white;
      font-size: 16px;
      font-weight: bold;
      text-align: center;
      text-shadow: 0 0 5px rgba(0, 0, 0, 0.5);
    }

    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(42, 161, 152, 0.7); }
      70% { box-shadow: 0 0 0 20px rgba(42, 161, 152, 0); }
      100% { box-shadow: 0 0 0 0 rgba(42, 161, 152, 0); }
    }

    .game-menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 300px;
      background: rgba(0, 0, 0, 0.85);
      border-radius: 15px;
      padding: 20px;
      box-shadow: 0 0 30px rgba(42, 161, 152, 0.7);
      z-index: 1001;
      display: none;
      backdrop-filter: blur(10px);
      border: 1px solid rgba(42, 161, 152, 0.5);
    }

    .game-menu h3 {
      color: #2aa198;
      text-align: center;
      margin-top: 0;
      font-size: 22px;
      text-shadow: 0 0 10px rgba(42, 161, 152, 0.7);
    }

    .game-item {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      padding: 12px;
      margin: 10px 0;
      cursor: pointer;
      transition: all 0.3s ease;
      border-left: 3px solid #2aa198;
    }

    .game-item:hover {
      background: rgba(42, 161, 152, 0.3);
      transform: translateX(5px);
    }

    .game-item .name {
      color: #fff;
      font-weight: bold;
      font-size: 16px;
    }

    .game-item .package {
      color: #aaa;
      font-size: 12px;
      margin-top: 5px;
    }

    .close-menu {
      position: absolute;
      top: 10px;
      right: 15px;
      color: #aaa;
      cursor: pointer;
      font-size: 20px;
    }

    .close-menu:hover {
      color: #2aa198;
    }

    .menu-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 999;
      display: none;
    }
  </style>
</head>

<body>
  <canvas id="canvas"></canvas>
  <div class="box">
    <div class="scene">
      <svg 
        version="1.1" 
        id="dc-spinner" 
        xmlns="http://www.w3.org/2000/svg" 
        x="0px" y="0px"
        width:"38"
        height:"38"
        viewBox="0 0 38 38" 
        preserveAspectRatio="xMinYMin meet"
      >
        <text x="7.5" y="21" font-family="Monaco" font-size="3px" style="letter-spacing:0.6; color:rgb(42, 161, 152); text-align:center;" fill="#2aa198">&nbsp;端口开启成功 
        </text>
        <path fill="#373a42" d="M20,35c-8.271,0-15-6.729-15-15S11.729,5,20,5s15,6.729,15,15S28.271,35,20,35z M20,5.203
          C11.841,5.203,5.203,11.841,5.203,20c0,8.159,6.638,14.797,14.797,14.797S34.797,28.159,34.797,20
          C34.797,11.841,28.159,5.203,20,5.203z">
        </path>

        <path fill="#373a42" d="M20,33.125c-7.237,0-13.125-5.888-13.125-13.125S12.763,6.875,20,6.875S33.125,12.763,33.125,20
          S27.237,33.125,20,33.125z M20,7.078C12.875,7.078,7.078,12.875,7.078,20c0,7.125,5.797,12.922,12.922,12.922
          S32.922,27.125,32.922,20C32.922,12.875,27.125,7.078,20,7.078z">
        </path>

        <path fill="#2AA198" stroke="#2AA198" stroke-width="0.6027" stroke-miterlimit="10" d="M5.203,20
          c0-8.159,6.638-14.797,14.797-14.797V5C11.729,5,5,11.729,5,20s6.729,15,15,15v-0.203C11.841,34.797,5.203,28.159,5.203,20z">
          <animateTransform
            attributeName="transform"
            type="rotate"
            from="0 20 20"
            to="360 20 20"
            calcMode="spline"
            keySplines="0.4, 0, 0.2, 1"
            keyTimes="0;1"
            dur="2s"
            repeatCount="indefinite" />      
        </path>

        <path fill="#859900" stroke="#859900" stroke-width="0.2027" stroke-miterlimit="10" d="M7.078,20
        c0-7.125,5.797-12.922,12.922-12.922V6.875C12.763,6.875,6.875,12.763,6.875,20S12.763,33.125,20,33.125v-0.203
        C12.875,32.922,7.078,27.125,7.078,20z">
          <animateTransform
            attributeName="transform"
            type="rotate"
            from="0 20 20"
            to="360 20 20"
            dur="1.8s"  
            repeatCount="indefinite" />
        </path>
      </svg>
      
      <!-- 可点击圆圈 -->
      <div class="clickable-circle" id="clickableCircle">
        <span>点击打开<br>应用游戏</span>
      </div>
      
      <!-- 游戏菜单 -->
      <div class="menu-overlay" id="menuOverlay"></div>
      <div class="game-menu" id="gameMenu">
        <span class="close-menu" id="closeMenu">×</span>
        <h3>选择游戏服务器</h3>
        <div class="game-item" data-package="com.tencent.ig">
          <div class="name">全球服</div>
          <div class="package">com.tencent.ig</div>
        </div>
        <div class="game-item" data-package="com.rekoo.pubgm">
          <div class="name">台湾服</div>
          <div class="package">com.rekoo.pubgm</div>
        </div>
        <div class="game-item" data-package="com.pubg.krmobile">
          <div class="name">日韩服</div>
          <div class="package">com.pubg.krmobile</div>
        </div>
        <div class="game-item" data-package="com.vng.pubgmobile">
          <div class="name">越南服</div>
          <div class="package">com.vng.pubgmobile</div>
        </div>
      </div>
      
      <div class="info">
        <div class="div1 d2"> </div>
        <div class="div1 d3"> 欢迎使用</div>
        <div class="div1 d4"> 凄凉祝您稳定奔放</div>
        <div class="div1 d5"> </div>

        <marquee behavior="scroll" direction="left" style="color:#E0FFFF">凄凉</marquee>

        <marquee behavior="scroll" direction="left" style="color:#E0FFFF">
          凄凉
        </marquee>

        <div id="clock">
          <p id="date" class="date"></p>
          <p id="time" class="time"></p>
          <p class="text"></p>
        </div>
      </div>
      
      <audio src="https://mpimg.cn/view.php/083ecb86d525ea04d58c032ecc2221a1.mp3" loop="loop" autoplay="autoplay" controls />
    </div>
  </div>

  <script>
    // 时钟功能
    var week = ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
    var timerID = setInterval(updateTime, 1000);
    updateTime();

    function updateTime() {
      var cd = new Date();
      document.getElementById("time").innerHTML = zeroPadding(cd.getHours(), 2) + ':' + zeroPadding(cd.getMinutes(), 2) + ':' + zeroPadding(cd.getSeconds(), 2);
      document.getElementById("date").innerHTML = zeroPadding(cd.getFullYear(), 4) + '-' + zeroPadding(cd.getMonth() + 1, 2) + '-' + zeroPadding(cd.getDate(), 2) + ' ' + week[cd.getDay()];
    };

    function zeroPadding(num, digit) {
      var zero = '';
      for (var i = 0; i < digit; i++) {
        zero += '0';
      }
      return (zero + num).slice(-digit);
    }

    // 可点击圆圈和游戏菜单功能
    document.addEventListener('DOMContentLoaded', function() {
      var clickableCircle = document.getElementById('clickableCircle');
      var gameMenu = document.getElementById('gameMenu');
      var menuOverlay = document.getElementById('menuOverlay');
      var closeMenu = document.getElementById('closeMenu');
      var gameItems = document.querySelectorAll('.game-item');
      
      // 点击圆圈打开菜单
      clickableCircle.addEventListener('click', function() {
        gameMenu.style.display = 'block';
        menuOverlay.style.display = 'block';
      });
      
      // 点击关闭按钮关闭菜单
      closeMenu.addEventListener('click', function() {
        gameMenu.style.display = 'none';
        menuOverlay.style.display = 'none';
      });
      
      // 点击遮罩层关闭菜单
      menuOverlay.addEventListener('click', function() {
        gameMenu.style.display = 'none';
        menuOverlay.style.display = 'none';
      });
      
      // 点击游戏项
      gameItems.forEach(function(item) {
        item.addEventListener('click', function() {
          var packageName = this.getAttribute('data-package');
          var gameName = this.querySelector('.name').textContent;
          
          alert('正在启动 ' + gameName + '\n包名: ' + packageName);
          
          // 在实际应用中，这里可以添加启动游戏的代码
          // 例如：window.location.href = 'intent://' + packageName + '#Intent;scheme=package;end;';
          
          // 关闭菜单
          gameMenu.style.display = 'none';
          menuOverlay.style.display = 'none';
        });
      });
    });

    // 原有的3D背景效果代码
    function project3D(x, y, z, vars) {
      var p, d;
      x -= vars.camX;
      y -= vars.camY - 8;
      z -= vars.camZ;
      p = Math.atan2(x, z);
      d = Math.sqrt(x * x + z * z);
      x = Math.sin(p - vars.yaw) * d;
      z = Math.cos(p - vars.yaw) * d;
      p = Math.atan2(y, z);
      d = Math.sqrt(y * y + z * z);
      y = Math.sin(p - vars.pitch) * d;
      z = Math.cos(p - vars.pitch) * d;
      var rx1 = -1000;
      var ry1 = 1;
      var rx2 = 1000;
      var ry2 = 1;
      var rx3 = 0;
      var ry3 = 0;
      var rx4 = x;
      var ry4 = z;
      var uc = (ry4 - ry3) * (rx2 - rx1) - (rx4 - rx3) * (ry2 - ry1);
      var ua = ((rx4 - rx3) * (ry1 - ry3) - (ry4 - ry3) * (rx1 - rx3)) / uc;
      var ub = ((rx2 - rx1) * (ry1 - ry3) - (ry2 - ry1) * (rx1 - rx3)) / uc;
      if (!z) z = 0.000000001;
      if (ua > 0 && ua < 1 && ub > 0 && ub < 1) {
        return {
          x: vars.cx + (rx1 + ua * (rx2 - rx1)) * vars.scale,
          y: vars.cy + y / z * vars.scale,
          d: (x * x + y * y + z * z)
        };
      } else {
        return { d: -1 };
      }
    }
    
    function elevation(x, y, z) {
      var dist = Math.sqrt(x * x + y * y + z * z);
      if (dist && z / dist >= -1 && z / dist <= 1) return Math.acos(z / dist);
      return 0.00000001;
    }
    
    function rgb(col) {
      col += 0.000001;
      var r = parseInt((0.5 + Math.sin(col) * 0.5) * 16);
      var g = parseInt((0.5 + Math.cos(col) * 0.5) * 16);
      var b = parseInt((0.5 - Math.sin(col) * 0.5) * 16);
      return "#" + r.toString(16) + g.toString(16) + b.toString(16);
    }
    
    function interpolateColors(RGB1, RGB2, degree) {
      var w2 = degree;
      var w1 = 1 - w2;
      return [w1 * RGB1[0] + w2 * RGB2[0], w1 * RGB1[1] + w2 * RGB2[1], w1 * RGB1[2] + w2 * RGB2[2]];
    }
    
    function rgbArray(col) {
      col += 0.000001;
      var r = parseInt((0.5 + Math.sin(col) * 0.5) * 256);
      var g = parseInt((0.5 + Math.cos(col) * 0.5) * 256);
      var b = parseInt((0.5 - Math.sin(col) * 0.5) * 256);
      return [r, g, b];
    }
    
    function colorString(arr) {
      var r = parseInt(arr[0]);
      var g = parseInt(arr[1]);
      var b = parseInt(arr[2]);
      return "#" + ("0" + r.toString(16)).slice(-2) + ("0" + g.toString(16)).slice(-2) + ("0" + b.toString(16)).slice(-2);
    }
    
    function process(vars) {
      if (vars.points.length < vars.initParticles) for (var i = 0; i < 5; ++i) spawnParticle(vars);
      var p, d, t;
      p = Math.atan2(vars.camX, vars.camZ);
      d = Math.sqrt(vars.camX * vars.camX + vars.camZ * vars.camZ);
      d -= Math.sin(vars.frameNo / 80) / 25;
      t = Math.cos(vars.frameNo / 300) / 165;
      vars.camX = Math.sin(p + t) * d;
      vars.camZ = Math.cos(p + t) * d;
      vars.camY = -Math.sin(vars.frameNo / 220) * 15;
      vars.yaw = Math.PI + p + t;
      vars.pitch = elevation(vars.camX, vars.camZ, vars.camY) - Math.PI / 2;
      var t;
      for (var i = 0; i < vars.points.length; ++i) {
        x = vars.points[i].x;
        y = vars.points[i].y;
        z = vars.points[i].z;
        d = Math.sqrt(x * x + z * z) / 1.0075;
        t = .1 / (1 + d * d / 5);
        p = Math.atan2(x, z) + t;
        vars.points[i].x = Math.sin(p) * d;
        vars.points[i].z = Math.cos(p) * d;
        vars.points[i].y += vars.points[i].vy * t * ((Math.sqrt(vars.distributionRadius) - d) * 2);
        if (vars.points[i].y > vars.vortexHeight / 2 || d < .25) {
          vars.points.splice(i, 1);
          spawnParticle(vars);
        }
      }
    }
    
    function drawFloor(vars) {
      var x, y, z, d, point, a;
      for (var i = -25; i <= 25; i += 1) {
        for (var j = -25; j <= 25; j += 1) {
          x = i * 2;
          z = j * 2;
          y = vars.floor;
          d = Math.sqrt(x * x + z * z);
          point = project3D(x, y - d * d / 85, z, vars);
          if (point.d != -1) {
            size = 1 + 15000 / (1 + point.d);
            a = 0.15 - Math.pow(d / 50, 4) * 0.15;
            if (a > 0) {
              vars.ctx.fillStyle = colorString(interpolateColors(rgbArray(d / 26 - vars.frameNo / 40), [0, 128, 32], .5 + Math.sin(d / 6 - vars.frameNo / 8) / 2));
              vars.ctx.globalAlpha = a;
              vars.ctx.fillRect(point.x - size / 2, point.y - size / 2, size, size);
            }
          }
        }
      }
      vars.ctx.fillStyle = "#82f";
      for (var i = -25; i <= 25; i += 1) {
        for (var j = -25; j <= 25; j += 1) {
          x = i * 2;
          z = j * 2;
          y = -vars.floor;
          d = Math.sqrt(x * x + z * z);
          point = project3D(x, y + d * d / 85, z, vars);
          if (point.d != -1) {
            size = 1 + 15000 / (1 + point.d);
            a = 0.15 - Math.pow(d / 50, 4) * 0.15;
            if (a > 0) {
              vars.ctx.fillStyle = colorString(interpolateColors(rgbArray(-d / 26 - vars.frameNo / 40), [32, 0, 128], .5 + Math.sin(-d / 6 - vars.frameNo / 8) / 2));
              vars.ctx.globalAlpha = a;
              vars.ctx.fillRect(point.x - size / 2, point.y - size / 2, size, size);
            }
          }
        }
      }
    }
    
    function sortFunction(a, b) {
      return b.dist - a.dist;
    }
    
    function draw(vars) {
      vars.ctx.globalAlpha = .15;
      vars.ctx.fillStyle = "#000";
      vars.ctx.fillRect(0, 0, canvas.width, canvas.height);
      drawFloor(vars);
      var point, x, y, z, a;
      for (var i = 0; i < vars.points.length; ++i) {
        x = vars.points[i].x;
        y = vars.points[i].y;
        z = vars.points[i].z;
        point = project3D(x, y, z, vars);
        if (point.d != -1) {
          vars.points[i].dist = point.d;
          size = 1 + vars.points[i].radius / (1 + point.d);
          d = Math.abs(vars.points[i].y);
          a = .8 - Math.pow(d / (vars.vortexHeight / 2), 1000) * .8;
          vars.ctx.globalAlpha = a >= 0 && a <= 1 ? a : 0;
          vars.ctx.fillStyle = rgb(vars.points[i].color);
          if (point.x > -1 && point.x < vars.canvas.width && point.y > -1 && point.y < vars.canvas.height) vars.ctx.fillRect(point.x - size / 2, point.y - size / 2, size, size);
        }
      }
      vars.points.sort(sortFunction);
    }
    
    function spawnParticle(vars) {
      var p, ls;
      pt = {};
      p = Math.PI * 2 * Math.random();
      ls = Math.sqrt(Math.random() * vars.distributionRadius);
      pt.x = Math.sin(p) * ls;
      pt.y = -vars.vortexHeight / 2;
      pt.vy = vars.initV / 20 + Math.random() * vars.initV;
      pt.z = Math.cos(p) * ls;
      pt.radius = 200 + 800 * Math.random();
      pt.color = pt.radius / 1000 + vars.frameNo / 250;
      vars.points.push(pt);
    }
    
    function frame(vars) {
      if (vars === undefined) {
        var vars = {};
        vars.canvas = document.querySelector("canvas");
        vars.ctx = vars.canvas.getContext("2d");
        vars.canvas.width = document.body.clientWidth;
        vars.canvas.height = document.body.clientHeight;
        window.addEventListener("resize", function () {
          vars.canvas.width = document.body.clientWidth;
          vars.canvas.height = document.body.clientHeight;
          vars.cx = vars.canvas.width / 2;
          vars.cy = vars.canvas.height / 2;
        }, true);
        vars.frameNo = 0;

        vars.camX = 0;
        vars.camY = 0;
        vars.camZ = -14;
        vars.pitch = elevation(vars.camX, vars.camZ, vars.camY) - Math.PI / 2;
        vars.yaw = 0;
        vars.cx = vars.canvas.width / 2;
        vars.cy = vars.canvas.height / 2;
        vars.bounding = 10;
        vars.scale = 500;
        vars.floor = 26.5;

        vars.points = [];
        vars.initParticles = 700;
        vars.initV = .01;
        vars.distributionRadius = 800;
        vars.vortexHeight = 25;
      }
      vars.frameNo++;
      requestAnimationFrame(function () {
        frame(vars);
      });
      process(vars);
      draw(vars);
    }
    frame();
  </script>
</body>
</html>
